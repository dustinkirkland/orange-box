# vim :set ts=2 et:
openstack:
  series: precise
  overrides:
    openstack-origin: cloud:precise-havana
    source: cloud:precise-updates/havana
  services:
    mysql:
      charm: cs:precise/mysql-29
      options:
        dataset-size: 50%
      to: lxc:3
    rabbitmq-server:
      charm: cs:precise/rabbitmq-server-16
      constraints: mem=1G
      to: lxc:3
    ceph:
      charm: cs:precise/ceph
      num_units: 3
      options:
        monitor-count: 3
        fsid: 9e7aac42-4bf4-11e3-b4b7-5254006a039c
        monitor-secret: AQAAvoJSOAv/NRAAgvXP8d7iXN7lWYbvDZzm2Q==
        osd-devices: /srv
        osd-reformat: "yes"
    keystone:
      charm: cs:precise/keystone-23
      options:
        admin-password: Password1+
        admin-token: ubuntutesting
      to: lxc:3
    openstack-dashboard:
      charm: cs:precise/openstack-dashboard-11
      options:
        offline-compression: "no"
      to: lxc:3
    nova-compute:
      charm: cs:precise/nova-compute
      num_units: 4
      options:
        config-flags: "auto_assign_floating_ip=False"
        enable-live-migration: False
        virt-type: kvm
    nova-cloud-controller:
      charm: cs:precise/nova-cloud-controller-19
      options:
        network-manager: Neutron
        quantum-security-groups: "yes"
      to: lxc:3
    neutron-gateway:
      charm: cs:precise/quantum-gateway-12
      options:
        ext-port: eth1
      to: 2
    cinder:
      charm: cs:precise/cinder-14
      options:
        block-device: "None"
      to: lxc:3
    glance:
      charm: cs:precise/glance-26
      to: lxc:3
    swift-proxy:
      charm: cs:precise/swift-proxy
      options:
        zone-assignment: manual
        replicas: 3
        use-https: 'no'
        swift-hash: fdfef9d4-8b06-11e2-8ac0-531c923c8fae
    swift-storage-z1:
      charm: cs:precise/swift-storage
      options:
        zone: 1
        block-device: vdb
        overwrite: "true"
    swift-storage-z2:
      charm: cs:precise/swift-storage
      options:
        zone: 2
        block-device: vdb
        overwrite: "true"
    swift-storage-z3:
      charm: cs:precise/swift-storage
      options:
        zone: 3
        block-device: vdb
        overwrite: "true"
    ceilometer:
      charm: cs:precise/ceilometer
      to: lxc:3
    ceilometer-agent:
      charm: cs:precise/ceilometer-agent
    mongodb:
      charm: cs:precise/mongodb
      to: lxc:3
    ntp:
      charm: cs:precise/ntp
  relations:
    - - keystone
      - mysql
    - - nova-cloud-controller
      - mysql
    - - nova-cloud-controller
      - rabbitmq-server
    - - nova-cloud-controller
      - glance
    - - nova-cloud-controller
      - keystone
    - - nova-compute
      - nova-cloud-controller
    - - nova-compute
      - mysql
    - - nova-compute
      - rabbitmq-server:amqp
    - - nova-compute
      - glance
    - - nova-compute
      - ceph
    - - glance
      - mysql
    - - glance
      - keystone
    - - glance
      - ceph
    - - glance
      - cinder
    - - cinder
      - mysql
    - - cinder
      - rabbitmq-server
    - - cinder
      - nova-cloud-controller
    - - cinder
      - keystone
    - - cinder
      - ceph
    - - neutron-gateway
      - mysql
    - - neutron-gateway
      - rabbitmq-server
    - - neutron-gateway
      - nova-cloud-controller
    - - openstack-dashboard
      - keystone
    - - swift-proxy
      - keystone
    - - swift-proxy
      - swift-storage-z1
    - - swift-proxy
      - swift-storage-z2
    - - swift-proxy
      - swift-storage-z3
    - - ceilometer
      - keystone
    - - ceilometer
      - rabbitmq-server
    - - ceilometer
      - mongodb
    - - ceilometer-agent:nova-ceilometer
      - nova-compute:nova-ceilometer
    - - ceilometer-agent:ceilometer-service
      - ceilometer:ceilometer-service
    - - ntp:juju-info
      - nova-compute:juju-info
    - - ntp:juju-info
      - nova-cloud-controller:juju-info
    - - ntp:juju-info
      - neutron-gateway:juju-info
    - - ntp:juju-info
      - ceph:juju-info
    - - ntp:juju-info
      - cinder:juju-info
    - - ntp:juju-info
      - keystone:juju-info
    - - ntp:juju-info
      - glance:juju-info
    - - ntp:juju-info
      - swift-proxy:juju-info
    - - ntp:juju-info
      - swift-storage-z1:juju-info
    - - ntp:juju-info
      - swift-storage-z2:juju-info
    - - ntp:juju-info
      - swift-storage-z3:juju-info
    - - ntp:juju-info
      - ceilometer:juju-info
    - - ntp:juju-info
      - mongodb:juju-info
    - - ntp:juju-info
      - rabbitmq-server:juju-info
    - - ntp:juju-info
      - mysql:juju-info
    - - ntp:juju-info
      - openstack-dashboard:juju-info
